## Fucntions
# ir whois
ir() { 
    whois $1.ir
}

# my ip
myip() {
  iface="${1}"
  the_curl() {
    [[ -z "${iface}" ]] && curl http://icanhazip.com/ || \
    curl --interface "${iface}" http://icanhazip.com/ 
    }
  the_curl "${iface}" && echo "first try" || \
  nc ifcfg.me 23 | awk 'FNR == 2 {print $4}'
}

# number of connections each IP address has
iptop () { 
    netstat -ntu | \
    awk '{print $5}' | \
    cut -d':' -f1 | \
    sort | \
    uniq -c | \
    sort -rn
}

# find sth in smw
fin() { 
    find "$2" -iname "*$1*"
}

# mark it listened when parsing files using mocp
rnmoc () {
    rename -v 's/mp3|MP3/mp3.\[listened\]/' "`mocp -Q "%file"`"
}

lower() { 
    rename -v 'y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/' *
}

flower() { 
    find -type f \
         -exec rename \
         -v 'y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/' {} \;  
}

# update only $this repo
update-repo() {
    for source in "$@".list; do
        sudo apt-get update -o Dir::Etc::sourcelist="sources.list.d/${source}" \
        -o Dir::Etc::sourceparts="-" -o APT::Get::List-Cleanup="0"    
    done
}

# courtsey of grml
restart () {
    exec $SHELL $SHELL_ARGS "$@"
}

# Download a file and display it locally
uopen() {
    emulate -L zsh
    if ! [[ -n "$1" ]] ; then
        print "Usage: uopen \$URL/\$file">&2
        return 1
    else
        FILE=$1
        MIME=$(curl --head $FILE | \
               grep Content-Type | \
               cut -d ' ' -f 2 | \
               cut -d\; -f 1)
        MIME=${MIME%$'\r'}
        curl $FILE | see ${MIME}:-
    fi
}

# Memory overview
memusage() {
    ps aux | awk '{if (NR > 1) print $5;
                   if (NR > 2) print "+"}
                   END { print "p" }' | dc
}


manperl(){ 
    man "$1" | perl -00ne "print if /^\s*$2\b/"; 
}

# switch to another ppp dev
sw2dev() {
  ls_them(){
    ip r | grep default ; ls /sys/devices/virtual/net/ | grep -v lo
}
  [[ -z "${1}" ]] && ls_them && return
  sudo ip r d default
  sudo ip r a default dev "${1}"
}

# list interfaces with ip
# courtsey of http://unix.stackexchange.com/users/13796/jordanm
lsis() {
  ip addr | awk '
  /^[0-9]+:/ { 
  sub(/:/,"",$2); iface=$2 } 
  /^[[:space:]]*inet / { 
  split($2, a, "/")
  print iface": "a[1] 
  }'
}

# wget using specific interface
wgw () {
  lsis | while IFS='' read -r line || [[ -n "$line" ]]; do
    echo "$line"
  done
}

# ping with interfaces
pi8() {
  ip=8.8.8.8
  iface="${1}"
  [[ -z "${iface}" ]] && ping -c 2 "${ip}" || ping -c 2 -I "${iface}" "${ip}"
}

## Aliases
# vcsh
alias v='vcsh'

# ls
alias l='ls -1S'
alias ll='ls -l'
alias la='ls -a'
alias lla='ls -la'

alias e='vim'
alias rr='rm -ri'
#alias rm='rm -i'
alias rm='trash-put'
alias pgg='ping google.com'
alias p4='ping 4.2.2.4'
alias p8='ping 8.8.8.8'
alias diff='colordiff'
alias dush='du -csh *|sort -h'
alias q='exit'
alias less='less -FX'
alias axl='axel -a -n 8'
alias scl='sudo systemctl'
alias ssh='ssh -o ServerAliveInterval=60'

alias scsv='curl -L http://git.io/unix'
alias i3l='i3lock -i ~/.config/i3/bsod.png'
alias ub='udisksctl mount -b'
alias cls='$HOME/bin/ls++'
alias bing='$HOME/bin/bingwallpaper -1'
alias trans='$HOME/bin/trans -t fa'
alias wtt='curl wttr.in/mashhad'

alias ports='netstat -tulnap'
alias dg='dig +{,no}short'
alias sira='sudo ip r a'
