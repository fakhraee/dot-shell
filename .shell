## Fucntions
# find sth in smw
fin() { 
    find "$2" -iname "*$1*"
}

# mark it listened when parsing files using mocp
rnmoc () {
    rename -v 's/mp3|MP3/mp3.\[listened\]/' "`mocp -Q "%file"`"
}

lower() { 
    rename -v 'y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/' "${1}"
}

flower() { 
    find -type f \
         -exec rename \
         -v 'y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/' {} \;  
}

# update only $this repo
update-repo() {
    for source in "$@".list; do
        sudo apt-get update -o Dir::Etc::sourcelist="sources.list.d/${source}" \
        -o Dir::Etc::sourceparts="-" -o APT::Get::List-Cleanup="0"    
    done
}

# courtsey of grml
restart () {
    exec $SHELL $SHELL_ARGS "$@"
}

# Download a file and display it locally
uopen() {
    emulate -L zsh
    if ! [[ -n "$1" ]] ; then
        print "Usage: uopen \$URL/\$file">&2
        return 1
    else
        FILE=$1
        MIME=$(curl --head $FILE | \
               grep Content-Type | \
               cut -d ' ' -f 2 | \
               cut -d\; -f 1)
        MIME=${MIME%$'\r'}
        curl $FILE | see ${MIME}:-
    fi
}

# Memory overview
memusage() {
    ps aux | awk '{if (NR > 1) print $5;
                   if (NR > 2) print "+"}
                   END { print "p" }' | dc
}


manperl(){ 
    man "$1" | perl -00ne "print if /^\s*$2\b/"; 
}

# get file and encode to mp3
mp3it() {
  slashnamedot="${1}"
  namewav="${2}"
  namedot="${slashnamedot##*/}"
  name="${namedot%%.*}"
  [[ -z "${namewav}" ]] && namewav="/$(pwd)/${name/:/BADHY}.wav"
  mplayer -quiet -ao pcm:file="${namewav}" -vo null "${slashnamedot}" && \
  lame "${namewav}" "${name}.mp3"
  /bin/rm "${namewav}"
}

# wrapper around virsh
virsh() {
  remote="${1}"
  hv="${2}"
  realvirsh="/usr/bin/virsh"
  [[ "${remote}" = "--remote" ]] && shift +2 &&  \
  "${realvirsh}" -c qemu+ssh://root@"${hv}"/system "$@" || \
  "${realvirsh}" "$@"
}

# send git diff to remote server
gdiffr() {
  host="${1}"
  git diff | ssh "${host}" 'cat - >/tmp/.gdiffr'
}

# du with sort
ds() {
  inpath="${1}"
  [[ -z "${inpath}" ]] && inpath=.
  du -sh "${inpath}"/* | sort -h
}

## Aliases
# vcsh
alias v='vcsh'

# ls
alias l='ls -1S'
alias ll='ls -l'
alias la='ls -a'
alias lla='ls -la'

alias e='vim'
alias rr='rm -ri'
alias rm='rm -i'
alias diff='colordiff'
alias dush='du -csh *|sort -h'
alias q='exit'
alias less='less -FX'
alias scl='sudo systemctl'
alias scsv='curl -L http://git.io/unix'
alias i3l='i3lock -i ~/.config/i3/lockimage && echo "Login on: $(date +%a-%m%d-%H%M%S)" >>~/var/login'
alias ub='udisksctl mount -b'
alias cls='$HOME/bin/ls++'
alias bing='$HOME/bin/bingwallpaper -1'
alias trans='$HOME/bin/trans -t fa'
alias wtt='curl wttr.in/mashhad'
alias ly='setxkbmap -layout us,ir -option "grp:alt_shift_toggle"'
alias lightup='xbacklight -inc 10'
alias lightdown='xbacklight -dec 10'
alias unuker='sudo aptitude purge "?installed(?name(linux-image-[0-9])) ?installed(?not($(uname -r)))"'
alias m='. /usr/lib/mc/mc-wrapper.sh'

alias ports='netstat -tulnap'
alias dg='dig +{,no}short'
alias pyweb='python -m SimpleHTTPServer'
alias axl='axel -a -n 8'
alias pgg='ping google.com'
alias p4='ping 4.2.2.4'
alias p8='ping 8.8.8.8'
alias ssh='ssh -o ServerAliveInterval=60'
alias sagent='eval $(ssh-agent -s)'
alias weechat='screen -DRS weechat'
